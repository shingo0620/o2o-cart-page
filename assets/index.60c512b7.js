import{r as e,c as t,d as a,v as s,o as r,a as n,t as l,b as u,e as o,u as c,f as i,l as d,g as p,h as g,i as m,j as v,k as f,F as x,w as y,m as w,n as h,p as b,q as C,s as k,x as S,y as I,z as U,V as _}from"./vendor.baeecfd8.js";const q=e(""),P=e(""),N=e([]),V=e(""),z=e([]),R=t((()=>`shop_${q.value}_cart_ttl`)),F=t((()=>`shop_${q.value}_cart_id`)),j=async e=>{q.value=e;const t=(await(s=e,new Promise(((e,t)=>{e({data:{id:s,name:"蓋婭科技",products:[{id:1,uuid:"1234-1234-1234",name:"香蔥麵包",unitPrice:25},{id:2,uuid:"qwer-qwer-qwer",name:"紅豆吐司",unitPrice:50},{id:3,uuid:"asdf-asdf-asdf",name:"蛋黃酥",unitPrice:30}]}})})))).data;var s;P.value=t.name,N.value=t.products;const r=localStorage.getItem(R.value),n=localStorage.getItem(F.value);n&&r&&!a.unix(r).isBefore(a())?(V.value=n,J()):$()},$=()=>{V.value=s(),localStorage.setItem(F.value,V.value),localStorage.setItem(V.value,JSON.stringify([])),O()},J=()=>{const e=JSON.parse(localStorage.getItem(V.value));z.value=e,O()},L=()=>{localStorage.setItem(V.value,JSON.stringify(z.value)),O()},O=()=>{let e=a().unix()+3600;localStorage.setItem(R.value,e)},A=e=>{const t=z.value.findIndex((t=>t.uuid===e));t>-1?z.value[t].quantity++:z.value.push({uuid:e,quantity:1}),L()},T=e=>{const t=z.value.findIndex((t=>t.uuid===e));t>-1&&z.value[t]--,L()},B=e=>{const t=z.value.findIndex((t=>t.uuid===e));t>-1&&z.value.splice(t,1),L()},D=()=>{z.value=[],L()},Q={props:{shopName:{type:String,default:"我的商店"}}},E={class:"bg-gray-700 text-center text-white w-100 py-4"};Q.render=function(e,t,a,s,u,o){return r(),n("nav",E,l(a.shopName)+" - 購物車 ",1)};const G={},H={class:"w-full absolute bottom-0 w-100 py-0 text-center text-gray-300 text-opacity-30"};G.render=function(e,t,a,s,l,u){return r(),n("footer",H," Copyright © 2021 蓋婭科技有限公司. All Rights Reserved. ")};const K={class:"d-flex"},M={expose:[],setup(e){u((()=>{const e=new URL(window.location.href).searchParams.get("shopId");j(e),t(window.location.href)}));const t=e=>{const t=new URL(e).searchParams.get("addItem");t&&A(t)};return(e,t)=>{const a=i("router-view");return r(),n("div",K,[o(Q,{shopName:c(P)},null,8,["shopName"]),o(a),o(G)])}}};d.add([p,g,m,v,f]);const W={props:{modelValue:Number,productUuid:[Number,String]},setup:e=>({addToCart:A,removeFromCart:B,reduceFromCart:T})},X={class:"flex justify-around px-1"},Y={class:"text-gray-800"};W.render=function(e,t,a,s,u,c){const d=i("font-awesome-icon");return r(),n("div",X,[a.modelValue>0?(r(),n(d,{key:0,icon:"minus",size:"lg",onClick:t[1]||(t[1]=e=>s.reduceFromCart(a.productUuid)),class:"text-gray-700 cursor-pointer"})):(r(),n(d,{key:1,icon:"trash",size:"lg",onClick:t[2]||(t[2]=e=>s.removeFromCart(a.productUuid)),class:"text-red-400 cursor-pointer"})),o("span",Y,l(a.modelValue),1),o(d,{icon:"plus",size:"lg",onClick:t[3]||(t[3]=e=>s.addToCart(a.productUuid)),class:"text-gray-700 cursor-pointer"})])};const Z={class:"flex flex-wrap w-full bg-gray-700 pb-2"},ee={class:"w-6/12 bg-gray-200 p-1"},te={class:"w-6/12 bg-green-200 p-1"},ae=o("a",{class:"w-full text-center rounded ring-2 ring-gray-700 ring-opacity-60 p-1"},"結帳",-1),se={class:"text-center w-9/12"},re={class:"p-5 bg-gray-700 text-white text-right"},ne={key:0},le=o("span",null,"總價格",-1),ue={class:"ml-2"},oe={key:1,class:"text-center"},ce={expose:[],setup(e){const a=t((()=>z.value.length<1||N.value.length<1?0:z.value.reduce(((e,t)=>{const a=N.value.find((e=>e.uuid===t.uuid));return e+t.quantity*(null==a?void 0:a.unitPrice)}),0))),s=e=>N.value.find((t=>t.uuid===e))||{};return(e,t)=>{const u=i("router-link"),d=i("font-awesome-icon");return r(),n("div",null,[o("div",Z,[o("div",ee,[o("button",{class:"w-full text-center rounded ring-2 ring-gray-700 ring-opacity-60 p-1",onClick:t[1]||(t[1]=(...e)=>c(D)&&c(D)(...e))},"清空購物車")]),o("div",te,[o(u,{to:{name:"Checkout"},class:"flex"},{default:y((()=>[ae])),_:1})])]),(r(!0),n(w,null,h(c(z),(e=>(r(),n("div",{class:"py-5 px-2 flex w-full",key:e.uuid},[o("div",se,l(s(e.uuid).name)+" ($"+l(s(e.uuid).unitPrice)+") ",1),o(W,{class:"ml-auto w-3/12",modelValue:e.quantity,"onUpdate:modelValue":t=>e.quantity=t,productUuid:e.uuid},null,8,["modelValue","onUpdate:modelValue","productUuid"])])))),128)),o("div",re,[c(z).length>0?(r(),n("div",ne,[le,o("span",ue,"$"+l(c(a)),1)])):(r(),n("div",oe," 請掃描商品 QR Code "))]),o(u,{to:{name:"Scan"}},{default:y((()=>[o(d,{icon:"camera-retro",size:"4x",class:"text-gray-700 cursor-pointer absolute right-3 bottom-3 z-10"})])),_:1})])}}},ie={expose:[],setup(e){const t=b(),a=e=>{s(e),t.push({name:"Cart"})},s=e=>{const t=new URL(e).searchParams.get("addItem");t&&A(t)};return(e,t)=>{const s=i("qrcode-stream"),l=i("font-awesome-icon"),u=i("router-link");return r(),n("div",null,[o(s,{onDecode:a}),o(u,{to:{name:"Cart"}},{default:y((()=>[o(l,{icon:"times-circle",size:"4x",class:"text-gray-700 cursor-pointer absolute right-3 bottom-3 z-10"})])),_:1})])}}},de={class:"w-full bg-gray-200 p-1"},pe=o("a",{class:"w-full p-1 text-center rounded ring-2 ring-gray-700 ring-opacity-60"},"返回購物車",-1),ge={class:"p-20 justify-center flex-wrap"},me=o("label",{class:"block text-center"},"付款總金額",-1),ve=o("p",{class:"text-center mt-4"},"如有需要請與店員確認結帳總金額是否正確",-1),fe={class:"flex flex-wrap w-full"},xe={class:"w-6/12 bg-gray-200 p-1"},ye=o("a",{class:"p-4 w-full text-center rounded ring-2 ring-gray-700 ring-opacity-60"},"信用卡",-1),we={class:"w-6/12 bg-green-200 p-1"},he=o("a",{class:"p-4 w-full text-center rounded ring-2 ring-gray-700 ring-opacity-60"},"Apple Pay",-1),be=[{path:"/",name:"Cart",component:ce},{path:"/scan",name:"Scan",component:ie},{path:"/checkout",name:"Checkout",component:{expose:[],setup(t){const a=e(0);return u((()=>{a.value=z.value.reduce(((e,t)=>e+N.value.find((e=>e.uuid===t.uuid)).unitPrice*t.quantity),0)})),(e,t)=>{const s=i("router-link");return r(),n(w,null,[o("div",de,[o(s,{to:{name:"Cart"},class:"flex"},{default:y((()=>[pe])),_:1})]),o("div",ge,[me,C(o("input",{class:"block p-4 text-4xl font-bold mx-auto mt-4 text-center border ring-4 rounded-lg","onUpdate:modelValue":t[1]||(t[1]=e=>a.value=e)},null,512),[[k,a.value]]),ve]),o("div",fe,[o("div",xe,[o(s,{to:{name:"Cart"},class:"flex"},{default:y((()=>[ye])),_:1})]),o("div",we,[o(s,{to:{name:"Checkout"},class:"flex"},{default:y((()=>[he])),_:1})])])],64)}}}}],Ce=S({history:I(),routes:be}),ke=U(M);ke.use(Ce),ke.use(_),ke.component("font-awesome-icon",x),ke.mount("#app");
